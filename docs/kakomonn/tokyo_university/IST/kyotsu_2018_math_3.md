---
comments: false
title: 東京大学 情報理工学研究科 2018年度 数学 第3問
tags:
  - Tokyo-University
---
# 東京大学 情報理工学研究科 2018年度 数学 第3問

## **Author**
[etsurin](https://zhuanlan.zhihu.com/p/561992447), 祭音Myyura

## **Description**
赤いカードが $2$ 枚と白いカードが $1$ 枚入った袋および複素数 $z_n, w_n \ (n=0, 1, 2, \ldots)$ について考える。
まず, 袋から $1$ 枚のカードを取り出し袋に戻す。
このとき取り出されたカードの色に応じて $z_{k+1} (k = 0, 1, 2,\ldots)$ を以下のルールで生成する。

$$
z_{k+1} = \begin{cases}
iz_k & \text{赤いカードが取り出された場合} \\
-iz_k & \text{白いカードが取り出された場合}
\end{cases}
$$

次に, 袋からもう一度 $1$ 枚のカードを取り出し袋に戻す。
このとき取り出したカードの色に応じて $w_{k+1}$ を以下のルールで生成する。

$$
w_{k+1} = \begin{cases}
-iw_k & \text{赤いカードが取り出された場合} \\
iw_k & \text{白いカードが取り出された場合}
\end{cases}
$$

ここで, 各カードは独立に等確率で取り出されるものとする。
また初期状態を $z_0 = 1, w_0 = 1$ とする。
すなわち, $z_n, w_n$ は, $z_0 = 1, w_0 = 1$ の状態から始め, 上記の一連の二つの操作を $n$ 回繰り返した後の値である。
なお, ここで $i$ は虚数単位とする。

以下の問いに答えよ。

(1) $n$ が奇数のとき $\text{Re}(z_n) = 0$, 偶数のとき $\text{Im}(z_n) = 0$ であることを示す。
ただし, $\text{Re}(z)$, $\text{Im}(z)$ はそれぞれ $z$ の実部, 虚部を表すものとする。

(2) $z_n = 1$ である確率を $P_n$, $z_n = i$ である確率を $Q_n$ とする。$P_n, Q_n$ についての漸近式を立てよ。

(3) $z_n = 1, z_n = i, z_n = -1, z_n = -i$ である確率をそれぞれ求めよ。

(4) $z_n$ の期待値が $(i/3)^n$ であることを示す。

(5) $z_n = w_n$ である確率を求めよ。

(6) $z_n + w_n$ の期待値を求めよ。

(7) $z_n w_n$ の期待値を求めよ。

## **Kai**
### (1)
使用数学归纳法证明。

$n = 0$ 时，$z_0, w_0$ 为实数；$n = 1$ 时，$z_1, w_1$ 可能取值为 $i, -i$，为纯虚数，满足条件。

假设 $n = 2k$ 时，$z_{2k}, w_{2k}$ 为实数，$n = 2k + 1$ 时，$z_{2k+1}, w_{2k+1}$ 为纯虚数。
则当 $n=2k+2$ 时，$z_{2k+2}, w_{2k+2}$ 可能取值为 $\pm iz_{2k+1}, \pm iw_{2k+1}$ 为实数；$z=2k+3$ 时，$z_{2k+3}, w_{2k+3}$ 可能取值为 $\pm iz_{2k+2}, \pm iw_{2k+2}$ 为纯虚数。

命题成立。

### (2)
$n$ 为偶数时，$z_n$ 可能取值为 $\pm 1$，$n$ 为奇数时，$z_n$ 可能取值为 $\pm i$。

考虑连续两次操作。

$$
P(\text{颜色相同}) = (\frac{2}{3})^2 + (\frac{1}{3})^2 = \frac{5}{9} \qquad P(\text{颜色不同}) = 2 \times \frac{2}{3} \times \frac{1}{3} = \frac{4}{9}
$$

对颜色相同的情况 $z_{n+2} = −z_n$，对颜色不同的情况 $z_{n+2} = z_n$。因此有

$$
P_{n+2} = \frac{4}{9}P_n + \frac{5}{9}(1 - P_n) = -\frac{1}{9}P_n + \frac{5}{9} \qquad (n \text{ 为偶数})
$$

$$
Q_{n+2} = \frac{4}{9}Q_n + \frac{5}{9}(1-Q_n) = -\frac{1}{9}Q_n + \frac{5}{9} \qquad (n \text{ 为奇数})
$$

### (3)

$$
P_{2k+2} - \frac{1}{2} = -\frac{1}{9}(P_{2k} - \frac{1}{2}) \qquad P_0 = 1
$$

$$
P_{2k} = \frac{1}{2}(-\frac{1}{9})^k + \frac{1}{2} \qquad k = 0, 1, 2, \ldots
$$

$$
Q_{2k+3} - \frac{1}{2} = -\frac{1}{9}(Q_{2k+1}-\frac{1}{2}) \qquad Q_1 = \frac{2}{3}
$$

$$
Q_{2k+1} = \frac{1}{6}(-\frac{1}{9})^k + \frac{1}{2} \qquad k = 0, 1, 2, \ldots
$$

$n = 2k$ 时

$$
P(z_n = i) = P(z_n = -i) = 0
$$

$$
P(z_n = 1) = \frac{1}{2}(-\frac{1}{9})^k + \frac{1}{2}
$$

$$
P(z_n = -1) = -\frac{1}{2}(-\frac{1}{9})^k + \frac{1}{2}
$$

$n = 2k + 1$ 时

$$
P(z_n = 1) = P(z_n = -1) = 0
$$

$$
P(z_n = i) = \frac{1}{6}(-\frac{1}{9})^k + \frac{1}{2}
$$

$$
P(z_n = -i) = -\frac{1}{6}(-\frac{1}{9})^k + \frac{1}{2}
$$

### (4)
$n = 2k$ 时

$$
\begin{aligned}
    E[z_n] &= 1 \times (\frac{1}{2} (-\frac{1}{9})^k + \frac{1}{2}) + (-1) \times (-\frac{1}{2} (-\frac{1}{9})^k + \frac{1}{2}) \\
    &= (-\frac{1}{9})^k = (\frac{i}{3})^{2k} = (\frac{i}{3})^n
\end{aligned}
$$

$n = 2k + 1$ 时

$$
\begin{aligned}
    E[z_n] &= i \times (\frac{1}{6} (-\frac{1}{9})^k + \frac{1}{2}) + (-i) \times (-\frac{1}{6} (-\frac{1}{9})^k + \frac{1}{2}) \\
    &= \frac{i}{3}(-\frac{1}{9})^k = (\frac{i}{3})^{2k+1} = (\frac{i}{3})^n
\end{aligned}
$$

### (5)
$w_n$ 的可能取值、递推式与 $z_n$ 相同，只是 $P(w_1=i) = \frac{1}{3}$。
$n = 2k$ 时，$z_n$ 与 $w_n$ 的概率分布相同。$n=2k+1$ 时，$P(w_n=1) = P(w_n=-1)=0$，$P(w_n=i) = -\frac{1}{6}(-\frac{1}{9})^k + \frac{1}{2}$，$P(w_n=-i) = \frac{1}{6}(-\frac{1}{9})^k + \frac{1}{2}$。

$n=2k$ 时

$$
P(z_n = w_n) = (\frac{1}{2}(-\frac{1}{9})^{k} + \frac{1}{2})^2 + (-\frac{1}{2}(-\frac{1}{9})^{k} + \frac{1}{2})^2 = \frac{1}{2}(-\frac{1}{9})^{2k} + \frac{1}{2}
$$

$n=2k+1$ 时

$$
P(z_n = w_n) = 2 \times (\frac{1}{6}(-\frac{1}{9})^{k} + \frac{1}{2}) \times (-\frac{1}{6}(-\frac{1}{9})^{k} + \frac{1}{2}) = \frac{1}{2} - \frac{1}{18}(-\frac{1}{9})^{2k}
$$

### (6)
由 (4) 同理可得到

$$
E[w_n] = (-\frac{i}{3})^n
$$

$$
E[w_n + z_n] = E[w_n] + E[z_n] = (-\frac{i}{3})^n + (\frac{i}{3})^n
$$

### (7)
$z_n, w_n$ 独立

$$
E[z_n, w_n] = E[z_n]E[w_n] = (\frac{1}{9})^n
$$